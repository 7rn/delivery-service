## Install

- Clone the repository

- Copy and rename .env.example into .env
 
- Adjust user data/ credential in .env

- Run `composer install`

- Run `php artisan passport:install`

- Copy passport data into .env , example :

```dotenv
PERSONAL_CLIENT_ID=1
PERSONAL_CLIENT_SECRET=rVs5BYgSaaW2WXdatoORu71gKjWxvu6DtJBt1X79
PASSWORD_CLIENT_ID=2
PASSWORD_CLIENT_SECRET=ErXFrQWWXRAqCONw3wbODE9cPsYvn9sO00WCAZbz
```

- Run `php artisan migrate`

- Run `php artisan db:seed`

- Run `php artisan serve`

## Register User

### Using Curl

The `phone` and `password` are required for register.

```git
curl -X POST http://localhost:8000/api/register -b cookies.txt -c cookies.txt -D headers.txt -H 'Content-Type: application/json' -d '
    {
        "name": "",
        "email": "",
        "phone": "098080808556",
        "password": "testpass"
    }
'
```

Header Response :

```text
HTTP/1.1 200 OK
Host: localhost:8000
Date: Mon, 26 Mar 2018 22:46:57 +0000
Connection: close
X-Powered-By: PHP/7.2.2
Cache-Control: no-cache, private
Date: Mon, 26 Mar 2018 22:46:57 GMT
Content-Type: application/json
X-RateLimit-Limit: 60
X-RateLimit-Remaining: 59
```

Body Response

```json
{
  "status": "success",
  "data"  : {
    "result" : {
      "name"      : null,
      "email"     : null,
      "phone"     : "098080808556",
      "updated_at": "2018-03-26 22:46:57",
      "created_at": "2018-03-26 22:46:57",
      "id"        : 2
    },
    "message": "User successfully registered"
  }
}
```

## Login

### Using Curl

Login using combination of `phone` and `password`.

```git
curl -X POST http://localhost:8000/api/login -b cookies.txt -c cookies.txt -D headers.txt -H 'Content-Type: application/json' -d '
    {
        "phone": "098080808556",
        "password": "testpass"
    }
'
```

Header Response

The refresh token saved as a HttpOnly cookie is to prevent Cross-site scripting (XSS) attacks. 
The HttpOnly flag tells the browser that this cookie should not be accessible through javascript.

```text
HTTP/1.1 200 OK
Host: localhost:8000
Date: Mon, 26 Mar 2018 23:03:11 +0000
Connection: close
X-Powered-By: PHP/7.2.2
Cache-Control: no-cache, private
Date: Mon, 26 Mar 2018 23:03:11 GMT
Content-Type: application/json
X-RateLimit-Limit: 60
X-RateLimit-Remaining: 58
Set-Cookie: refreshToken=def50200339b77228e6b23fcd811eeb4b6a7d840923e0bd354ae69d2f3c3343b1fad3da11bd81ff250c4e4ef7e861353282892f87b77c9f3ff09810e555756c29435b341bea2914fa8dcb77e63127bcf42ab5bb044cc63d573b01b2019de057454c1fc1b67146b69b710462638d6236e91673bf3077f854998f5acaa9adf4044c4328aa2360140e7b072cbed97237a927ed545d66306687a014f2dd40b6a51b9313548d1dfe9db2a2095639513149ef4e0d2b4aeed3066502d77f5c7c066adb4257fad968f1f147dd32ffada398140ed04c581737477617ce7da806450b14a8d8bb6195cb05cd1c95146aaa01575aa92a35aaefe1b436c572582d39d7bcfb9a70374a258dae7485a4a3daa2b2cf6d2b0cce8f7ad799edd16e1d676b27a3711020e2d196e6fe60aab8d356d4f138ab2771481de0b41a8a1673c9de855fd97917adb46b3e2414dd4efdbe914c88465d7c232525ab62a73019a18f852b6837b3f7528; expires=Sat, 16-Nov-2019 23:03:11 GMT; Max-Age=51840000; path=/; HttpOnly
```

Cookies

```txt
# Netscape HTTP Cookie File
# https://curl.haxx.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.

#HttpOnly_localhost	FALSE	/	FALSE	1573945391	refreshToken	def50200339b77228e6b23fcd811eeb4b6a7d840923e0bd354ae69d2f3c3343b1fad3da11bd81ff250c4e4ef7e861353282892f87b77c9f3ff09810e555756c29435b341bea2914fa8dcb77e63127bcf42ab5bb044cc63d573b01b2019de057454c1fc1b67146b69b710462638d6236e91673bf3077f854998f5acaa9adf4044c4328aa2360140e7b072cbed97237a927ed545d66306687a014f2dd40b6a51b9313548d1dfe9db2a2095639513149ef4e0d2b4aeed3066502d77f5c7c066adb4257fad968f1f147dd32ffada398140ed04c581737477617ce7da806450b14a8d8bb6195cb05cd1c95146aaa01575aa92a35aaefe1b436c572582d39d7bcfb9a70374a258dae7485a4a3daa2b2cf6d2b0cce8f7ad799edd16e1d676b27a3711020e2d196e6fe60aab8d356d4f138ab2771481de0b41a8a1673c9de855fd97917adb46b3e2414dd4efdbe914c88465d7c232525ab62a73019a18f852b6837b3f7528
```

Body Response

```json
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImUwODA0YjBmMDE0MWVjYzkwYzQ5MmY5NmExNTZkMGRiZWMzYzIxMTdmYzRiMjQwNTFjNWVhZjU4YmE1ZjllMGIwMmUwN2ZjMGU5N2Q3MjQ2In0.eyJhdWQiOiIyIiwianRpIjoiZTA4MDRiMGYwMTQxZWNjOTBjNDkyZjk2YTE1NmQwZGJlYzNjMjExN2ZjNGIyNDA1MWM1ZWFmNThiYTVmOWUwYjAyZTA3ZmMwZTk3ZDcyNDYiLCJpYXQiOjE1MjIxMDUzOTAsIm5iZiI6MTUyMjEwNTM5MCwiZXhwIjoxNTIyMTA1OTkwLCJzdWIiOiIyIiwic2NvcGVzIjpbXX0.XdCOlAFeO49WNZQw0LlcUsE40MhlV5kxf51jf0mShYqJDIpYujK9CPGNK6wXZCUgNjeO_KTjUVZI9MfnOw-Wnlptopg_Bu52Rq7kd-woyk5PSazT8aIf-KysnZa0BZEwS4PPDsk-M0RojGWwt4y1iFnVltriHBv09V9Nqr2AL92otLgdvtmzVRCimaMLSfIEj87lfKA6M-zBTU9x5IvmsV6khZdyDdRjofeX8W9BYiwfsDuuJ3cKoB_CFav8Mo7wB-SWgEQzK4ahs8zq_ZOK1CmdmlnZh1l8lszBZ39nOnIHPZQXbSo9lGX2msvVFzXsY98fCZvjauWTjiUGYvoUkHfavHR3zlo8kca5Xs2CMxIodwb4t8h_8xNlGeGztUTnb2MXh1cdO--OlIxzUdBu4CrSR99xvzmC9TfnwZoJmmvQf3Lf_Fh7r_Wb9Y_cPitbg3xMbw3UddxJYbNjaqgL5_tbEZ35RvNDUfvT6FDF8nRQ1R7rCAB5ERBNwY6Fbut6bNg34cFu0qH0ruHP-AVdJM7sEBpgVqcSWaCecN0eiSB7EwRVnnGKmilcF_lywU3u_sSNTHdPgz-yt6N6svV06iO8sOqsFU4qbG2hBcciEgVDrvSqt98Eiu9viLs9NICWVB0-qcVnK8UUdC6aEsxVzMAFlKXqLL5Kwy4GtJxZkyc",
  "expires_in"  : 600
}
```

## Refresh token

### Using Curl

```git
curl -X POST http://localhost:8000/api/login/refresh -b cookies.txt -c cookies.txt -D headers.txt -H 'Content-Type: application/json' -d '
    {}
'
```

Header Response

```text
HTTP/1.1 200 OK
Host: localhost:8000
Date: Mon, 26 Mar 2018 23:13:04 +0000
Connection: close
X-Powered-By: PHP/7.2.2
Cache-Control: no-cache, private
Date: Mon, 26 Mar 2018 23:13:04 GMT
Content-Type: application/json
X-RateLimit-Limit: 60
X-RateLimit-Remaining: 58
Set-Cookie: refreshToken=def5020044d3d95ef7478c94515e9b748c17c8a9889f562ffbb8c08bfd0a483a5efe4733f71505b36f49d27907e5072e8bf36140d0a2905d2ed4778a3bcbcee948af90d8654cd2dec5c1a1cb0b205da04eda8710b5a10247b779e83b86b0d3b17b16919960266f8478dfd8375c57b1a6c678d9e25552c9ff11803edf477cc8e70d885ffbf80e2bc7cfac274ccc87c0b8c2e3b5379eb8e7489baa8e65ccbc707b1429912072c06bff6904df2bb8870cbfa31f53f70aedba93cd2bc7a08ffe891b874651a6c00f7d7699beab47d1afab4307b4491d1fa48990c6b2a159e0349451606110e9e8df81bfcb01c4a8627d6d015f31880f3b2f855b646b1f87bb9cbb334351630600bbcbc0bde767e98e84a2000de51b9a9f00ac5faa0b1bd3377813b597da2d9db17a7caedf0b76cde7b7ebbaa578d7d9960ca6f8d6c781ebba2fa78b4af1168cd3612a00d86ea27e1214b46d14fa759ad2999141343dc613ab440dce47; expires=Sat, 16-Nov-2019 23:13:04 GMT; Max-Age=51840000; path=/; HttpOnly
```

Body Response

```json
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFjYjg3MmVkMzI2YTlkNTljNDg4ZGVhNTk0NTFhYWQ4YTM2YjY4MGI5YjMyZTlkZjU4MGQ5ZmQwYjFiNGMzMDYzZmQ0YTI1ODRiZmI0ZDBlIn0.eyJhdWQiOiIyIiwianRpIjoiYWNiODcyZWQzMjZhOWQ1OWM0ODhkZWE1OTQ1MWFhZDhhMzZiNjgwYjliMzJlOWRmNTgwZDlmZDBiMWI0YzMwNjNmZDRhMjU4NGJmYjRkMGUiLCJpYXQiOjE1MjIxMDU5ODMsIm5iZiI6MTUyMjEwNTk4MywiZXhwIjoxNTIyMTA2NTgzLCJzdWIiOiIyIiwic2NvcGVzIjpbXX0.tpiHXsDIKF4FnITXi-7ejbTIDH6_mPQhnz-qsHWvIP6BM8FuzSlca9aFCLjO_UAMRB5NLtnkNAin08f4PMIdGcwLx5RyL_gHpcZEgFtpOGGNEMHBvcrSQ5W5crZx9yasEbQfZBl4sleL_jz2Osb7-teoIWnqxa1tbgnnwew-OJdRL81ROoqYhgB0Trm2ZNVbdohONk42ao9I5A7islwH90pfQQGnfMS5KNoNcPV6DhEmpTfbYAkrOy5xL-MqEL9FtOULeFM0Dmn5NAC7Dk-cbg6Pn2WfZq8I5vMP4qgXgfvEAnqO3yXPAlabsbKXVQHpvqLyAHrCaphfvMJOkNN08FBSdq1ePRZMqNZo5Wwj8BnflfNlqLANyo5MZIvArwpBUaSTu7kIISmvC4lWe1K2srTKscs2GB8DPaKYIDVfGjny2NZ-FAlRLkT-I6EvKOdhS3MMfXaAbxiD27sev6uzAo61k7V3fM3AshEuXgRM-mEekZSm7GkXcke35pUWdfjUpAaVkz_8mL-2eplazh-sJRU8M2EKDgleAqPwIiE_P4XtOiAuE0wNYE3tvWH3SpN704NuoafjsbRJ43TNsYesUH95vGAY_544WWlCWb_9vB3k2Jzl6IB0XKzoNfHrPBC6SPG9TLl-kHTcV-HHxSkdvLSBVkh-THkY56Cle8kvhd4",
  "expires_in"  : 599
}
```

### Order delivery service

### Using Curl

The _type_, _originAddress_, and _destinationAddress_ are required
Option for type can have 1 (PLA), 2 (PAL), 3 (PLL)

```git
curl -X --header "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFjYjg3MmVkMzI2YTlkNTljNDg4ZGVhNTk0NTFhYWQ4YTM2YjY4MGI5YjMyZTlkZjU4MGQ5ZmQwYjFiNGMzMDYzZmQ0YTI1ODRiZmI0ZDBlIn0.eyJhdWQiOiIyIiwianRpIjoiYWNiODcyZWQzMjZhOWQ1OWM0ODhkZWE1OTQ1MWFhZDhhMzZiNjgwYjliMzJlOWRmNTgwZDlmZDBiMWI0YzMwNjNmZDRhMjU4NGJmYjRkMGUiLCJpYXQiOjE1MjIxMDU5ODMsIm5iZiI6MTUyMjEwNTk4MywiZXhwIjoxNTIyMTA2NTgzLCJzdWIiOiIyIiwic2NvcGVzIjpbXX0.tpiHXsDIKF4FnITXi-7ejbTIDH6_mPQhnz-qsHWvIP6BM8FuzSlca9aFCLjO_UAMRB5NLtnkNAin08f4PMIdGcwLx5RyL_gHpcZEgFtpOGGNEMHBvcrSQ5W5crZx9yasEbQfZBl4sleL_jz2Osb7-teoIWnqxa1tbgnnwew-OJdRL81ROoqYhgB0Trm2ZNVbdohONk42ao9I5A7islwH90pfQQGnfMS5KNoNcPV6DhEmpTfbYAkrOy5xL-MqEL9FtOULeFM0Dmn5NAC7Dk-cbg6Pn2WfZq8I5vMP4qgXgfvEAnqO3yXPAlabsbKXVQHpvqLyAHrCaphfvMJOkNN08FBSdq1ePRZMqNZo5Wwj8BnflfNlqLANyo5MZIvArwpBUaSTu7kIISmvC4lWe1K2srTKscs2GB8DPaKYIDVfGjny2NZ-FAlRLkT-I6EvKOdhS3MMfXaAbxiD27sev6uzAo61k7V3fM3AshEuXgRM-mEekZSm7GkXcke35pUWdfjUpAaVkz_8mL-2eplazh-sJRU8M2EKDgleAqPwIiE_P4XtOiAuE0wNYE3tvWH3SpN704NuoafjsbRJ43TNsYesUH95vGAY_544WWlCWb_9vB3k2Jzl6IB0XKzoNfHrPBC6SPG9TLl-kHTcV-HHxSkdvLSBVkh-THkY56Cle8kvhd4" POST http://localhost:8000/api/login -b cookies.txt -c cookies.txt -D headers.txt -H 'Content-Type: application/json' -d '
    {
        'name' : '',
        'reference' :'',
        'contact' :'',
        'type' : '3',
        'originName' : '',
        'originAddress' : 'Test Origin Address ',
        'destinationName' : '',
        'destinationAddress' : 'Test Destination Address',
        'userId' : '',
    }
'
```

Body Response

```json
{
  "status": "success",
  "data"  : {
    "result" : [
      {
        "name"               : null,
        "reference"          : null,
        "contact"            : null,
        "type_name"          : "PAL",
        "type_description"   : "Origin Address, Destination Locker",
        "origin_name"        : null,
        "origin_address"     : "Test Origin Address 1",
        "destination_name"   : null,
        "destination_address": "Test Destination Addrees 1"
      }
    ],
    "message": "Order successfully saved"
  }
}
```

## Order History

### Using Curl

```git
curl -X --header "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFjYjg3MmVkMzI2YTlkNTljNDg4ZGVhNTk0NTFhYWQ4YTM2YjY4MGI5YjMyZTlkZjU4MGQ5ZmQwYjFiNGMzMDYzZmQ0YTI1ODRiZmI0ZDBlIn0.eyJhdWQiOiIyIiwianRpIjoiYWNiODcyZWQzMjZhOWQ1OWM0ODhkZWE1OTQ1MWFhZDhhMzZiNjgwYjliMzJlOWRmNTgwZDlmZDBiMWI0YzMwNjNmZDRhMjU4NGJmYjRkMGUiLCJpYXQiOjE1MjIxMDU5ODMsIm5iZiI6MTUyMjEwNTk4MywiZXhwIjoxNTIyMTA2NTgzLCJzdWIiOiIyIiwic2NvcGVzIjpbXX0.tpiHXsDIKF4FnITXi-7ejbTIDH6_mPQhnz-qsHWvIP6BM8FuzSlca9aFCLjO_UAMRB5NLtnkNAin08f4PMIdGcwLx5RyL_gHpcZEgFtpOGGNEMHBvcrSQ5W5crZx9yasEbQfZBl4sleL_jz2Osb7-teoIWnqxa1tbgnnwew-OJdRL81ROoqYhgB0Trm2ZNVbdohONk42ao9I5A7islwH90pfQQGnfMS5KNoNcPV6DhEmpTfbYAkrOy5xL-MqEL9FtOULeFM0Dmn5NAC7Dk-cbg6Pn2WfZq8I5vMP4qgXgfvEAnqO3yXPAlabsbKXVQHpvqLyAHrCaphfvMJOkNN08FBSdq1ePRZMqNZo5Wwj8BnflfNlqLANyo5MZIvArwpBUaSTu7kIISmvC4lWe1K2srTKscs2GB8DPaKYIDVfGjny2NZ-FAlRLkT-I6EvKOdhS3MMfXaAbxiD27sev6uzAo61k7V3fM3AshEuXgRM-mEekZSm7GkXcke35pUWdfjUpAaVkz_8mL-2eplazh-sJRU8M2EKDgleAqPwIiE_P4XtOiAuE0wNYE3tvWH3SpN704NuoafjsbRJ43TNsYesUH95vGAY_544WWlCWb_9vB3k2Jzl6IB0XKzoNfHrPBC6SPG9TLl-kHTcV-HHxSkdvLSBVkh-THkY56Cle8kvhd4" POST http://localhost:8000/api/login -b cookies.txt -c cookies.txt -D headers.txt -H 'Content-Type: application/json' -d '
'
```

Body Response

```json
{
    "status": "success",
    "data": {
        "result": [
            {
                "name": null,
                "reference": null,
                "contact": null,
                "type_name": "PAL",
                "type_description": "Origin Address, Destination Locker",
                "origin_name": null,
                "origin_address": "Test Origin Address 1",
                "destination_name": null,
                "destination_address": "Test Destination Addrees 1"
            },
            {
                "name": null,
                "reference": null,
                "contact": null,
                "type_name": "PLA",
                "type_description": "Origin Locker, Destination Address",
                "origin_name": null,
                "origin_address": "Test Origin Address 2",
                "destination_name": null,
                "destination_address": "Test Destination Addrees 2"
            },
            {
                "name": null,
                "reference": null,
                "contact": null,
                "type_name": "PLL",
                "type_description": "Origin Locker, Destination Locker",
                "origin_name": null,
                "origin_address": "Test Origin Address 3",
                "destination_name": null,
                "destination_address": "Test Destination Addrees 3"
            },
            {
                "name": null,
                "reference": null,
                "contact": null,
                "type_name": "PLA",
                "type_description": "Origin Locker, Destination Address",
                "origin_name": null,
                "origin_address": "Test Origin Address 4",
                "destination_name": null,
                "destination_address": "Test Destination Addrees 4"
            }
        ],
        "message": "Order history successfully loaded"
    }
}
```

## Logout

### Using Curl

```git
curl -X --header "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjQ2MWJiOGZjOWYxNzVjNmJjMmNjOTQ5YzU2MDJiZTVjMjBiNTc1NTMzMmMwNDI3YzliOTRmOWE2ZDc5YmE0YmZlY2MzZGIyMGY1M2NjZGUxIn0.eyJhdWQiOiIyIiwianRpIjoiNDYxYmI4ZmM5ZjE3NWM2YmMyY2M5NDljNTYwMmJlNWMyMGI1NzU1MzMyYzA0MjdjOWI5NGY5YTZkNzliYTRiZmVjYzNkYjIwZjUzY2NkZTEiLCJpYXQiOjE1MjIxMDg5MDQsIm5iZiI6MTUyMjEwODkwNCwiZXhwIjoxNTIyMTA5NTA0LCJzdWIiOiIyIiwic2NvcGVzIjpbXX0.Ers_tUjo3cs5RSe-2i0gDBBKRUdJpvlNDRf8raMqD5XiRSpGJrYnz2MKPwGmCSxuX4AUYl-0OSAtMT1Lm25zEb2dKjDkCw2PmirIb3jDhSWDxs9pBZ_ArU_AE_p3eu0XWOY5W4z3CaDD5Bcm_CByC4U7jiXAVu6fMh9PsId87GprdYcJkSL9OVuYTliq7b_xYKDxuQ0lWlwqNbpgjlxJT5WH6gRD3ycR6aLTkXUOq7UQOQhxUlFA9RGPIDYUfmJJQk12oOuOwfVLXsYxqS9gvSiUdK4IAU3F7m81NRAuqVTBQXLjId9AV2SeJ7UhDJruuwkNozQNYAow8m4gTXkCPOZX3ScpR5Tx0WrSXQyTI2sroACf2odqMu3abOrN5AiNHwupkv6lLsFOCXBXicwBhiw2EQl_v8Ta2wBLoY5AaJVzf881Nsvfv9n4Tgw8lwePraZ47qpr8LR3EwDIz-WgbtVmuyGKQeWYhh_-43heavLvNd0Ep1zJnWLP2fst4mjPspM0PgpzdlDI0HXO1UoiuVQ4DZu6gqSVQ1-kmC88AO2ZtPMjfhXLyjcCmwzTsykBSPXkMaioZuxfVVxt_Pr1p3qzN-nRnhc01XnitAkpAueK7uHycdgZC0KBNsbyTF60_x8kjG_ZEm1Gdn3TZQ9nMhUiotwLIuqfqyQ6USOqkv8" POST http://localhost:8000/api/logout -b cookies.txt -c cookies.txt -D headers.txt -H 'Content-Type: application/json' -d '
'
```

- Exported database located at `database/sql`

- Unit test located at `tests/unit`